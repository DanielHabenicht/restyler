<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">{-| This module provides 'throwEither' and 'catchEither' for 'Either'.  These two
    functions reside here because 'throwEither' and 'catchEither' correspond to 'return'
    and ('&gt;&gt;=') for the flipped 'Either' monad: 'EitherR'.  Additionally, this
    module defines 'handleE' as the flipped version of 'catchE' for 'ExceptT'.

    'throwEither' and 'catchEither' improve upon @MonadError@ because:

    * 'catchEither' is more general than 'catch' and allows you to change the left value's type

    * Both are Haskell98

    More advanced users can use 'EitherR' and 'ExceptRT' to program in an
    entirely symmetric \&quot;success monad\&quot; where exceptional results are the norm
    and successful results terminate the computation.  This allows you to chain
    error-handlers using @do@ notation and pass around exceptional values of
    varying types until you can finally recover from the error:

&gt; runExceptRT $ do
&gt;     e2   &lt;- ioExceptionHandler e1
&gt;     bool &lt;- arithmeticExceptionhandler e2
&gt;     when bool $ lift $ putStrLn &quot;DEBUG: Arithmetic handler did something&quot;

    If any of the above error handlers 'succeed', no other handlers are tried.

    If you choose not to typefully distinguish between the error and sucess
    monad, then use 'flipEither' and 'flipET', which swap the type variables without
    changing the type.
-}</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">EitherR</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-33"></a><span>    </span><span class="hs-comment">-- * EitherR</span><span>
</span><a name="line-34"></a><span>    </span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-type">EitherR</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span>    </span><span class="hs-comment">-- ** Operations in the EitherR monad</span><span>
</span><a name="line-37"></a><span>    </span><a href="Data.EitherR.html#succeed"><span class="hs-identifier hs-var">succeed</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span>    </span><span class="hs-comment">-- ** Conversions to the Either monad</span><span>
</span><a name="line-40"></a><span>    </span><a href="Data.EitherR.html#throwEither"><span class="hs-identifier hs-var">throwEither</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>    </span><a href="Data.EitherR.html#catchEither"><span class="hs-identifier hs-var">catchEither</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>    </span><a href="Data.EitherR.html#handleEither"><span class="hs-identifier hs-var">handleEither</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>    </span><a href="Data.EitherR.html#fmapL"><span class="hs-identifier hs-var">fmapL</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>    </span><span class="hs-comment">-- ** Flip alternative</span><span>
</span><a name="line-46"></a><span>    </span><a href="Data.EitherR.html#flipEither"><span class="hs-identifier hs-var">flipEither</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span>    </span><span class="hs-comment">-- * ExceptRT</span><span>
</span><a name="line-49"></a><span>    </span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-type">ExceptRT</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span>    </span><span class="hs-comment">-- ** Operations in the ExceptRT monad</span><span>
</span><a name="line-52"></a><span>    </span><a href="Data.EitherR.html#succeedT"><span class="hs-identifier hs-var">succeedT</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span>    </span><span class="hs-comment">-- ** Conversions to the ExceptT monad</span><span>
</span><a name="line-55"></a><span>    </span><a href="Data.EitherR.html#handleE"><span class="hs-identifier hs-var">handleE</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>    </span><a href="Data.EitherR.html#fmapLT"><span class="hs-identifier hs-var">fmapLT</span></a><span class="hs-special">,</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>    </span><span class="hs-comment">-- ** Flip alternative</span><span>
</span><a name="line-59"></a><span>    </span><a href="Data.EitherR.html#flipET"><span class="hs-identifier hs-var">flipET</span></a><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Applicative</span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;*&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Alternative</span><span class="hs-special">(</span><span class="hs-identifier hs-var">empty</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;|&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">liftM</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">ap</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadPlus</span><span class="hs-special">(</span><span class="hs-identifier hs-var">mzero</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mplus</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadTrans</span><span class="hs-special">(</span><span class="hs-identifier hs-var">lift</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span class="hs-special">(</span><span class="hs-identifier hs-var">liftIO</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Except</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ExceptT</span><span class="hs-special">(</span><span class="hs-identifier hs-var">ExceptT</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">runExceptT</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">throwE</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">catchE</span><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span class="hs-special">(</span><span class="hs-identifier hs-var">mempty</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Except</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">{-| If \&quot;@Either e r@\&quot; is the error monad, then \&quot;@EitherR r e@\&quot; is the
    corresponding success monad, where:

    * 'return' is 'throwEither'.

    * ('&gt;&gt;=') is 'catchEither'.

    * Successful results abort the computation
-}</span><span>
</span><a name="line-80"></a><span class="hs-keyword">newtype</span><span> </span><a name="EitherR"><a href="Data.EitherR.html#EitherR"><span class="hs-identifier">EitherR</span></a></a><span> </span><a name="local-6989586621679070861"><a href="#local-6989586621679070861"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679070862"><a href="#local-6989586621679070862"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="EitherR"><a href="Data.EitherR.html#EitherR"><span class="hs-identifier">EitherR</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="runEitherR"><a href="Data.EitherR.html#runEitherR"><span class="hs-identifier">runEitherR</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679070862"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679070861"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><span class="hs-special">(</span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-type">EitherR</span></a><span> </span><a href="#local-6989586621679070903"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-83"></a><span>    </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftM</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><span class="hs-special">(</span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-type">EitherR</span></a><span> </span><a href="#local-6989586621679070902"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-86"></a><span>    </span><a name="local-3458764513820541680"><span class="hs-identifier">pure</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-87"></a><span>    </span><span class="hs-special">(</span><a name="local-3458764513820541679"><span class="hs-operator">&lt;*&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ap</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><span class="hs-special">(</span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-type">EitherR</span></a><span> </span><a href="#local-6989586621679070896"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-90"></a><span>    </span><a name="local-3458764513820541102"><span class="hs-identifier">return</span></a><span> </span><a name="local-6989586621679070897"><a href="#local-6989586621679070897"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-var">EitherR</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679070897"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>    </span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-var">EitherR</span></a><span> </span><a name="local-6989586621679070898"><a href="#local-6989586621679070898"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-3458764513820541099"><span class="hs-operator">&gt;&gt;=</span></a><span> </span><a name="local-6989586621679070899"><a href="#local-6989586621679070899"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679070898"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-92"></a><span>        </span><span class="hs-identifier hs-var">Left</span><span>  </span><a name="local-6989586621679070900"><a href="#local-6989586621679070900"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070899"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679070900"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-93"></a><span>        </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679070901"><a href="#local-6989586621679070901"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-var">EitherR</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679070901"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679070891"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Alternative</span><span> </span><span class="hs-special">(</span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-type">EitherR</span></a><span> </span><a href="#local-6989586621679070891"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-96"></a><span>    </span><a name="local-8214565720323790343"><span class="hs-identifier">empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-var">EitherR</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier hs-var">mempty</span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>    </span><a name="local-6989586621679070892"><a href="#local-6989586621679070892"><span class="hs-identifier">e1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-var">EitherR</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-8214565720323790342"><span class="hs-operator">&lt;|&gt;</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070892"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-98"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-operator">&lt;|&gt;</span><span> </span><a name="local-6989586621679070893"><a href="#local-6989586621679070893"><span class="hs-identifier">e2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-var">EitherR</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679070893"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-99"></a><span>    </span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-var">EitherR</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679070894"><a href="#local-6989586621679070894"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;|&gt;</span><span> </span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-var">EitherR</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679070895"><a href="#local-6989586621679070895"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-var">EitherR</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mappend</span><span> </span><a href="#local-6989586621679070894"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="#local-6989586621679070895"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679070890"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">MonadPlus</span><span> </span><span class="hs-special">(</span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-type">EitherR</span></a><span> </span><a href="#local-6989586621679070890"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-103"></a><span>    </span><a name="local-8214565720323790346"><span class="hs-identifier">mzero</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-104"></a><span>    </span><a name="local-8214565720323790345"><span class="hs-identifier">mplus</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;|&gt;</span><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">-- | Complete error handling, returning a result</span><span>
</span><a name="line-107"></a><span class="hs-identifier">succeed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679070931"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-type">EitherR</span></a><span> </span><a href="#local-6989586621679070931"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679070932"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-108"></a><a name="succeed"><a href="Data.EitherR.html#succeed"><span class="hs-identifier">succeed</span></a></a><span> </span><a name="local-6989586621679070933"><a href="#local-6989586621679070933"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-var">EitherR</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679070933"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-comment">-- | 'throwEither' in the error monad corresponds to 'return' in the success monad</span><span>
</span><a name="line-111"></a><span class="hs-identifier">throwEither</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679070929"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679070929"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679070930"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-112"></a><a name="throwEither"><a href="Data.EitherR.html#throwEither"><span class="hs-identifier">throwEither</span></a></a><span> </span><a name="local-6989586621679070934"><a href="#local-6989586621679070934"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">runEitherR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679070934"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-comment">-- | 'catchEither' in the error monad corresponds to ('&gt;&gt;=') in the success monad</span><span>
</span><a name="line-115"></a><span class="hs-identifier">catchEither</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679070926"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679070927"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070926"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679070928"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679070927"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679070928"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679070927"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-116"></a><a name="local-6989586621679070935"><a href="#local-6989586621679070935"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">`</span><a name="catchEither"><a href="Data.EitherR.html#catchEither"><span class="hs-identifier">catchEither</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679070936"><a href="#local-6989586621679070936"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">runEitherR</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-var">EitherR</span></a><span> </span><a href="#local-6989586621679070935"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679070937"><a href="#local-6989586621679070937"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-var">EitherR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070936"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679070937"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">-- | 'catchEither' with the arguments flipped</span><span>
</span><a name="line-119"></a><span class="hs-identifier">handleEither</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070923"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679070924"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679070925"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679070923"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679070925"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679070924"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679070925"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-120"></a><a name="handleEither"><a href="Data.EitherR.html#handleEither"><span class="hs-identifier">handleEither</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Data.EitherR.html#catchEither"><span class="hs-identifier hs-var">catchEither</span></a><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-comment">-- | Map a function over the 'Left' value of an 'Either'</span><span>
</span><a name="line-123"></a><span class="hs-identifier">fmapL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070920"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070921"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679070920"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679070922"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679070921"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679070922"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-124"></a><a name="fmapL"><a href="Data.EitherR.html#fmapL"><span class="hs-identifier">fmapL</span></a></a><span> </span><a name="local-6989586621679070938"><a href="#local-6989586621679070938"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">runEitherR</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621679070938"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.EitherR.html#EitherR"><span class="hs-identifier hs-var">EitherR</span></a><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-comment">-- | Flip the type variables of 'Either'</span><span>
</span><a name="line-127"></a><span class="hs-identifier">flipEither</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679070918"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679070919"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679070919"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679070918"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-128"></a><a name="flipEither"><a href="Data.EitherR.html#flipEither"><span class="hs-identifier">flipEither</span></a></a><span> </span><a name="local-6989586621679070939"><a href="#local-6989586621679070939"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679070939"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-129"></a><span>    </span><span class="hs-identifier hs-var">Left</span><span>  </span><a name="local-6989586621679070940"><a href="#local-6989586621679070940"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679070940"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-130"></a><span>    </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679070941"><a href="#local-6989586621679070941"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span>  </span><a href="#local-6989586621679070941"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-comment">-- | 'EitherR' converted into a monad transformer</span><span>
</span><a name="line-133"></a><span class="hs-keyword">newtype</span><span> </span><a name="ExceptRT"><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier">ExceptRT</span></a></a><span> </span><a name="local-6989586621679070858"><a href="#local-6989586621679070858"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679070859"><a href="#local-6989586621679070859"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679070860"><a href="#local-6989586621679070860"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ExceptRT"><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier">ExceptRT</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="runExceptRT"><a href="Data.EitherR.html#runExceptRT"><span class="hs-identifier">runExceptRT</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679070860"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679070859"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679070858"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679070888"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><span class="hs-special">(</span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-type">ExceptRT</span></a><span> </span><a href="#local-6989586621679070889"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679070888"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-136"></a><span>    </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftM</span><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679070886"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><span class="hs-special">(</span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-type">ExceptRT</span></a><span> </span><a href="#local-6989586621679070887"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679070886"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-139"></a><span>    </span><a name="local-3458764513820541680"><span class="hs-identifier">pure</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-140"></a><span>    </span><span class="hs-special">(</span><a name="local-3458764513820541679"><span class="hs-operator">&lt;*&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ap</span><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679070878"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><span class="hs-special">(</span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-type">ExceptRT</span></a><span> </span><a href="#local-6989586621679070879"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679070878"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-143"></a><span>    </span><a name="local-3458764513820541102"><span class="hs-identifier">return</span></a><span> </span><a name="local-6989586621679070880"><a href="#local-6989586621679070880"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-var">ExceptRT</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">throwE</span><span> </span><a href="#local-6989586621679070880"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>    </span><a name="local-6989586621679070881"><a href="#local-6989586621679070881"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-3458764513820541099"><span class="hs-operator">&gt;&gt;=</span></a><span> </span><a name="local-6989586621679070882"><a href="#local-6989586621679070882"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-var">ExceptRT</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ExceptT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-145"></a><span>        </span><a name="local-6989586621679070883"><a href="#local-6989586621679070883"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">runExceptT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">runExceptRT</span><span> </span><a href="#local-6989586621679070881"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-146"></a><span>        </span><span class="hs-identifier hs-var">runExceptT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">runExceptRT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679070883"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-147"></a><span>            </span><span class="hs-identifier hs-var">Left</span><span>  </span><a name="local-6989586621679070884"><a href="#local-6989586621679070884"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070882"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679070884"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-148"></a><span>            </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679070885"><a href="#local-6989586621679070885"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-var">ExceptRT</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679070885"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679070868"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679070869"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Alternative</span><span> </span><span class="hs-special">(</span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-type">ExceptRT</span></a><span> </span><a href="#local-6989586621679070869"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679070868"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-151"></a><span>    </span><a name="local-8214565720323790343"><span class="hs-identifier">empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-var">ExceptRT</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ExceptT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-152"></a><span>    </span><a name="local-6989586621679070870"><a href="#local-6989586621679070870"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-8214565720323790342"><span class="hs-operator">&lt;|&gt;</span></a><span> </span><a name="local-6989586621679070871"><a href="#local-6989586621679070871"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-var">ExceptRT</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">ExceptT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-153"></a><span>        </span><a name="local-6989586621679070872"><a href="#local-6989586621679070872"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">runExceptT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">runExceptRT</span><span> </span><a href="#local-6989586621679070870"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-154"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679070872"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-155"></a><span>            </span><span class="hs-identifier hs-var">Left</span><span>  </span><a name="local-6989586621679070873"><a href="#local-6989586621679070873"><span class="hs-identifier">l</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679070873"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-156"></a><span>            </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679070874"><a href="#local-6989586621679070874"><span class="hs-identifier">r1</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-157"></a><span>                </span><a name="local-6989586621679070875"><a href="#local-6989586621679070875"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">runExceptT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">runExceptRT</span><span> </span><a href="#local-6989586621679070871"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-158"></a><span>                </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679070875"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-159"></a><span>                    </span><span class="hs-identifier hs-var">Left</span><span>  </span><a name="local-6989586621679070876"><a href="#local-6989586621679070876"><span class="hs-identifier">l</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679070876"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span>                    </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679070877"><a href="#local-6989586621679070877"><span class="hs-identifier">r2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mappend</span><span> </span><a href="#local-6989586621679070874"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="#local-6989586621679070877"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679070866"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679070867"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">MonadPlus</span><span> </span><span class="hs-special">(</span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-type">ExceptRT</span></a><span> </span><a href="#local-6989586621679070867"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679070866"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-163"></a><span>    </span><a name="local-8214565720323790346"><span class="hs-identifier">mzero</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-164"></a><span>    </span><a name="local-8214565720323790345"><span class="hs-identifier">mplus</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;|&gt;</span><span class="hs-special">)</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">MonadTrans</span><span> </span><span class="hs-special">(</span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-type">ExceptRT</span></a><span> </span><a href="#local-6989586621679070865"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-167"></a><span>    </span><a name="local-8214565720323793354"><span class="hs-identifier">lift</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-var">ExceptRT</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">ExceptT</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">liftM</span><span> </span><span class="hs-identifier hs-var">Left</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679070863"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">MonadIO</span><span> </span><span class="hs-special">(</span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-type">ExceptRT</span></a><span> </span><a href="#local-6989586621679070864"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679070863"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-170"></a><span>    </span><a name="local-8214565720323787252"><span class="hs-identifier">liftIO</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">liftIO</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-comment">-- | Complete error handling, returning a result</span><span>
</span><a name="line-173"></a><span class="hs-identifier">succeedT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679070915"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679070916"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-type">ExceptRT</span></a><span> </span><a href="#local-6989586621679070916"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679070915"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679070917"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-174"></a><a name="succeedT"><a href="Data.EitherR.html#succeedT"><span class="hs-identifier">succeedT</span></a></a><span> </span><a name="local-6989586621679070942"><a href="#local-6989586621679070942"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.EitherR.html#ExceptRT"><span class="hs-identifier hs-var">ExceptRT</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679070942"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-comment">-- | 'catchE' with the arguments flipped</span><span>
</span><a name="line-177"></a><span class="hs-identifier">handleE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679070911"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070912"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679070913"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679070911"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679070914"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679070912"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679070911"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679070914"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679070913"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679070911"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679070914"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-178"></a><a name="handleE"><a href="Data.EitherR.html#handleE"><span class="hs-identifier">handleE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">catchE</span><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-comment">-- | Map a function over the 'Left' value of an 'ExceptT'</span><span>
</span><a name="line-181"></a><span class="hs-cpp">#if MIN_VERSION_base(4,8,0)</span><span>
</span><a name="line-182"></a><span class="hs-identifier">fmapLT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="#local-6989586621679070907"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679070908"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679070909"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679070908"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679070907"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679070910"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679070909"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679070907"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679070910"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-183"></a><a name="fmapLT"><a href="Data.EitherR.html#fmapLT"><span class="hs-identifier">fmapLT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Control</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Monad</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Trans</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Except</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">withExceptT</span><span>
</span><a name="line-184"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-185"></a><span class="hs-identifier">fmapLT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ExceptT</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ExceptT</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-186"></a><span class="hs-identifier">fmapLT</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">runExceptRT</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">ExceptRT</span><span>
</span><a name="line-187"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-comment">-- | Flip the type variables of an 'ExceptT'</span><span>
</span><a name="line-190"></a><span class="hs-identifier">flipET</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679070904"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679070905"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679070904"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679070906"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679070906"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679070904"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679070905"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-191"></a><a name="flipET"><a href="Data.EitherR.html#flipET"><span class="hs-identifier">flipET</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ExceptT</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">liftM</span><span> </span><a href="Data.EitherR.html#flipEither"><span class="hs-identifier hs-var">flipEither</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">runExceptT</span><span>
</span><a name="line-192"></a></pre></body></html>